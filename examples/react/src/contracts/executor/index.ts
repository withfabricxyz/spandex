import type { Address, Chain, PublicClient, WalletClient } from "viem";

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Executor
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

export const executorAbi = [
  { type: "constructor", inputs: [], stateMutability: "nonpayable" },
  { type: "receive", stateMutability: "payable" },
  {
    type: "function",
    inputs: [
      {
        name: "settings",
        internalType: "struct ExecutionSettings",
        type: "tuple",
        components: [
          { name: "quoteAmount", internalType: "uint256", type: "uint256" },
          { name: "minOutputAmount", internalType: "uint256", type: "uint256" },
          { name: "blockDeadline", internalType: "uint64", type: "uint64" },
          { name: "inputToken", internalType: "address", type: "address" },
          {
            name: "inputTokenAmount",
            internalType: "uint256",
            type: "uint256",
          },
          { name: "receiver", internalType: "address", type: "address" },
        ],
      },
      { name: "actions", internalType: "bytes[]", type: "bytes[]" },
    ],
    name: "execute",
    outputs: [],
    stateMutability: "payable",
  },
  {
    type: "function",
    inputs: [
      { name: "amount0Delta", internalType: "int256", type: "int256" },
      { name: "amount1Delta", internalType: "int256", type: "int256" },
      { name: "", internalType: "bytes", type: "bytes" },
    ],
    name: "pancakeV3SwapCallback",
    outputs: [],
    stateMutability: "nonpayable",
  },
  {
    type: "function",
    inputs: [
      { name: "amount0Delta", internalType: "int256", type: "int256" },
      { name: "amount1Delta", internalType: "int256", type: "int256" },
      { name: "", internalType: "bytes", type: "bytes" },
    ],
    name: "uniswapV3SwapCallback",
    outputs: [],
    stateMutability: "nonpayable",
  },
  {
    type: "function",
    inputs: [{ name: "data", internalType: "bytes", type: "bytes" }],
    name: "unlockCallback",
    outputs: [{ name: "", internalType: "bytes", type: "bytes" }],
    stateMutability: "nonpayable",
  },
  {
    type: "event",
    anonymous: false,
    inputs: [
      {
        name: "inputToken",
        internalType: "address",
        type: "address",
        indexed: true,
      },
      {
        name: "outputToken",
        internalType: "address",
        type: "address",
        indexed: true,
      },
      {
        name: "inputAmount",
        internalType: "uint256",
        type: "uint256",
        indexed: false,
      },
      {
        name: "outputAmount",
        internalType: "uint256",
        type: "uint256",
        indexed: false,
      },
    ],
    name: "RouteExecuted",
  },
  {
    type: "error",
    inputs: [{ name: "deadline", internalType: "uint64", type: "uint64" }],
    name: "DeadlinePassed",
  },
  { type: "error", inputs: [], name: "InvalidAccount" },
  {
    type: "error",
    inputs: [{ name: "sender", internalType: "address", type: "address" }],
    name: "InvalidCallbackArgs",
  },
  { type: "error", inputs: [], name: "InvalidCapture" },
  {
    type: "error",
    inputs: [
      { name: "sender", internalType: "address", type: "address" },
      { name: "expected", internalType: "address", type: "address" },
    ],
    name: "InvalidSender",
  },
  {
    type: "error",
    inputs: [
      { name: "token0", internalType: "address", type: "address" },
      { name: "token1", internalType: "address", type: "address" },
    ],
    name: "InvalidSplit",
  },
  {
    type: "error",
    inputs: [{ name: "token", internalType: "address", type: "address" }],
    name: "InvalidUnwrapToken",
  },
  {
    type: "error",
    inputs: [{ name: "token", internalType: "address", type: "address" }],
    name: "InvalidWrapToken",
  },
  {
    type: "error",
    inputs: [{ name: "outputAmount", internalType: "uint256", type: "uint256" }],
    name: "SlippageLimitExceeded",
  },
  {
    type: "error",
    inputs: [{ name: "index", internalType: "uint32", type: "uint32" }],
    name: "StepOutputFailure",
  },
  {
    type: "error",
    inputs: [{ name: "action", internalType: "uint256", type: "uint256" }],
    name: "UnknownActionCode",
  },
] as const;

// This file is auto-generated. Do not edit.
export const bytecode =
  "0x60a0604052348015600e575f5ffd5b50734200000000000000000000000000000000000006608052608051611a4361005a5f395f8181605101528181610a4801528181610abb01528181610aef0152610b600152611a435ff3fe608060405260043610610041575f3560e01c806323a69e75146100d1578063581416e0146100f057806391dd734614610103578063fa461e33146100d1575f5ffd5b366100cd57336001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001614806100875750336001600160a01b0360025c16145b33906001600160a01b0360025c16906100cb5760405163708986dd60e11b81526001600160a01b039283166004820152911660248201526044015b60405180910390fd5b005b5f5ffd5b3480156100dc575f5ffd5b506100cb6100eb36600461126b565b610138565b6100cb6100fe3660046112b9565b6101f6565b34801561010e575f5ffd5b5061012261011d36600461133f565b610387565b60405161012f91906113ab565b60405180910390f35b5f5f61014261052d565b915091508086148061015357508085145b339061017e5760405163e2f0f55360e01b81526001600160a01b0390911660048201526024016100c2565b5060405163a9059cbb60e01b8152336004820152602481018290526001600160a01b0383169063a9059cbb906044016020604051808303815f875af11580156101c9573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101ed91906113d1565b50505050505050565b61020660608401604085016113ea565b6001600160401b031643111561022260608501604086016113ea565b9061024c57604051636768091360e01b81526001600160401b0390911660048201526024016100c2565b50610273608084018035906102649060608701611432565b6001600160a01b031690610585565b505f8061029d6102896080870160608801611432565b60808701356102988688611501565b610627565b9150915084602001358210156102c957604051631920afa360e11b8152600481018390526024016100c2565b5f806102db60c0880160a08901611432565b6001600160a01b0316146102fe576102f960c0870160a08801611432565b610300565b335b90506103166001600160a01b03831682856106af565b6001600160a01b0382166103306080880160608901611432565b6001600160a01b03167f0a375a0cc2726055bd450b30e717ced9b43083fc8c88bc0e43413d8684e8d19d886080013586604051610377929190918252602082015260400190565b60405180910390a3505050505050565b60605f5f61039361052d565b90925090505f6103a5858701876115b3565b80519091506001600160a01b038481169116145f6103c28461164c565b90505f60405180606001604052808415158152602001838152602001846103fd5773fffd8963efd1fc6a506488495d951d5263988d25610404565b6401000276a45b6001600160a01b0390811690915260408051633cf3645360e21b8152875183166004820152602080890151841660248301528883015162ffffff166044830152606089015160020b60648301526080890151841660848301528451151560a483015284015160c48201529083015190911660e48201526101206101048201525f6101248201819052919250339190829063f3cd914c90610144016020604051808303815f875af11580156104ba573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104de9190611666565b90506104fa82875f01516104f28460801d90565b600f0b610710565b61050d8287602001516104f284600f0b90565b60405180602001604052805f815250985050505050505050505b92915050565b5f80336001600160a01b0360025c1681811461056f5760405163708986dd60e11b81526001600160a01b039283166004820152911660248201526044016100c2565b50505060015c6001600160a01b0316915f5c9150565b806001600160a01b0383166105b9578134146105b45760405163e10d68f760e01b815260040160405180910390fd5b610527565b34156105d85760405163e10d68f760e01b815260040160405180910390fd5b5f6105eb846001600160a01b0316610956565b90506106026001600160a01b03851633308661097f565b80610615856001600160a01b0316610956565b61061f919061167d565b949350505050565b81835f5b83518110156106a6575f5f61065886848151811061064b5761064b611690565b60200260200101516109d8565b915063ffffffff16915061066e84868484610a05565b90955093505f85900361069c57604051630bb66f0f60e31b815263ffffffff841660048201526024016100c2565b505060010161062b565b50935093915050565b6001600160a01b0382166106d657604051630da30f6560e31b815260040160405180910390fd5b6001600160a01b0383166106fc576106f76001600160a01b03831682610f3c565b505050565b6106f76001600160a01b0384168383610f59565b805f0361073257604051631920afa360e11b81525f60048201526024016100c2565b5f8112156108f757604051632961046560e21b81526001600160a01b03838116600483015284169063a5841194906024015f604051808303815f87803b15801561077a575f5ffd5b505af115801561078c573d5f5f3e3d5ffd5b5050506001600160a01b0383169050610810576001600160a01b0383166311da60b46107b78361164c565b6040518263ffffffff1660e01b815260040160206040518083038185885af11580156107e5573d5f5f3e3d5ffd5b50505050506040513d601f19601f8201168201806040525081019061080a9190611666565b50505050565b6001600160a01b03821663a9059cbb846108298461164c565b6040516001600160e01b031960e085901b1681526001600160a01b03909216600483015260248201526044016020604051808303815f875af1158015610871573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061089591906113d1565b50826001600160a01b03166311da60b46040518163ffffffff1660e01b81526004016020604051808303815f875af11580156108d3573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061080a9190611666565b604051630b0d9c0960e01b81526001600160a01b03838116600483015230602483015260448201839052841690630b0d9c09906064015f604051808303815f87803b158015610944575f5ffd5b505af11580156101ed573d5f5f3e3d5ffd5b5f6001600160a01b03821661096c575047919050565b6105276001600160a01b03831630610fa3565b60405181606052826040528360601b602c526323b872dd60601b600c5260205f6064601c5f895af18060015f5114166109ca57803d873b1517106109ca57637939f4245f526004601cfd5b505f60605260405250505050565b5f606060e06109ea8484016020015190565b8451911c92506109fe908490600490610fcd565b9050915091565b5f80636cba3883198401610ae1576001600160a01b03861615610a4657604051631b3fc75560e01b81526001600160a01b03871660048201526024016100c2565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663d0e30db0866040518263ffffffff1660e01b81526004015f604051808303818588803b158015610a9f575f5ffd5b505af1158015610ab1573d5f5f3e3d5ffd5b50505050508491507f00000000000000000000000000000000000000000000000000000000000000009050610f33565b6304a46f79198401610bca577f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316866001600160a01b031614610b4a576040516348ef2df960e11b81526001600160a01b03871660048201526024016100c2565b604051632e1a7d4d60e01b8152600481018690527f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031690632e1a7d4d906024015f604051808303815f87803b158015610ba9575f5ffd5b505af1158015610bbb573d5f5f3e3d5ffd5b505050508491505f9050610f33565b63f5449b1c198401610d20575f5f5f5f5f87806020019051810190610bef91906116b5565b945094509450945094508a6001600160a01b031663a9059cbb868c6040518363ffffffff1660e01b8152600401610c3b9291906001600160a01b03929092168252602082015260400190565b6020604051808303815f875af1158015610c57573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610c7b91906113d1565b50610c87858383611033565b6040516370a0823160e01b81523060048201526001600160a01b038516906370a0823190602401602060405180830381865afa158015610cc9573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610ced9190611666565b965083955080871015610d1657604051631920afa360e11b8152600481018890526024016100c2565b5050505050610f33565b63a39c6920198401610d65575f5f5f5f5f87806020019051810190610d4591906116b5565b94509450945094509450610d5a8b8b876110b8565b610c8785838c6110fc565b637f14d851198401610dc6575f5f5f5f86806020019051810190610d899190611763565b9350935093509350610d9c8a8a866110b8565b610da684826111b9565b610db8836001600160a01b0316610956565b955082945050505050610f33565b633150f625198401610e00575f83806020019051810190610de7919061185a565b9050610df4878783610627565b9093509150610f339050565b63a9894827198401610f17575f5f84806020019051810190610e22919061188b565b90925090505f5b8251811015610f0f575f612710848381518110610e4857610e48611690565b602002602001015161ffff168a610e5f919061194e565b610e699190611965565b90505f5f610e8285858151811061064b5761064b611690565b915091505f5f610e9a8e868663ffffffff1686610a05565b91509150886001600160a01b0316816001600160a01b03161480610ec557506001600160a01b038916155b818a9091610ef957604051636d65aab560e11b81526001600160a01b039283166004820152911660248201526044016100c2565b5091995097505060019093019250610e29915050565b505050610f33565b60405163240c0cab60e01b8152600481018590526024016100c2565b94509492505050565b5f385f3884865af1610f555763b12d13eb5f526004601cfd5b5050565b816014528060345263a9059cbb60601b5f5260205f604460105f875af18060015f511416610f9957803d853b151710610f99576390b8ec185f526004601cfd5b505f603452505050565b5f816014526370a0823160601b5f5260208060246010865afa601f3d111660205102905092915050565b60608351828111610fdc578092505b838111610fe7578093505b508183101561102c5750604051828203848401601f19601f830181165b8281015185820152810180611004575050508060208301015f81526020810160405250808252505b9392505050565b5f808315611042575081611046565b8291505b604080515f8152602081019182905263022c0d9f60e01b9091526001600160a01b0386169063022c0d9f906110849085908590309060248101611984565b5f604051808303815f87803b15801561109b575f5ffd5b505af11580156110ad573d5f5f3e3d5ffd5b505050505050505050565b826001805c6001600160a01b0319166001600160a01b03831617905d5081805f5d50806002805c6001600160a01b0319166001600160a01b03831617905d50505050565b5f8261111c5773fffd8963efd1fc6a506488495d951d5263988d25611123565b6401000276a45b604051630251596160e31b81523060048201528415156024820152604481018490526001600160a01b03808316606483015260a060848301525f60a48301529192509085169063128acb089060c40160408051808303815f875af115801561118d573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906111b191906119ba565b505050505050565b6040516348c8949160e01b81526001600160a01b038316906348c89491906111e59084906004016113ab565b5f604051808303815f875af1158015611200573d5f5f3e3d5ffd5b505050506040513d5f823e601f3d908101601f191682016040526106f791908101906119dc565b5f5f83601f840112611237575f5ffd5b5081356001600160401b0381111561124d575f5ffd5b602083019150836020828501011115611264575f5ffd5b9250929050565b5f5f5f5f6060858703121561127e575f5ffd5b843593506020850135925060408501356001600160401b038111156112a1575f5ffd5b6112ad87828801611227565b95989497509550505050565b5f5f5f83850360e08112156112cc575f5ffd5b60c08112156112d9575f5ffd5b5083925060c08401356001600160401b038111156112f5575f5ffd5b8401601f81018613611305575f5ffd5b80356001600160401b0381111561131a575f5ffd5b8660208260051b840101111561132e575f5ffd5b939660209190910195509293505050565b5f5f60208385031215611350575f5ffd5b82356001600160401b03811115611365575f5ffd5b61137185828601611227565b90969095509350505050565b5f81518084528060208401602086015e5f602082860101526020601f19601f83011685010191505092915050565b602081525f61102c602083018461137d565b805180151581146113cc575f5ffd5b919050565b5f602082840312156113e1575f5ffd5b61102c826113bd565b5f602082840312156113fa575f5ffd5b81356001600160401b038116811461102c575f5ffd5b6001600160a01b0381168114611424575f5ffd5b50565b80356113cc81611410565b5f60208284031215611442575f5ffd5b813561102c81611410565b634e487b7160e01b5f52604160045260245ffd5b60405160a081016001600160401b03811182821017156114835761148361144d565b60405290565b604051601f8201601f191681016001600160401b03811182821017156114b1576114b161144d565b604052919050565b5f6001600160401b038211156114d1576114d161144d565b5060051b60200190565b5f6001600160401b038211156114f3576114f361144d565b50601f01601f191660200190565b5f61151361150e846114b9565b611489565b8381526020810190600585901b84013681111561152e575f5ffd5b845b818110156115a85780356001600160401b0381111561154d575f5ffd5b860136601f82011261155d575f5ffd5b803561156b61150e826114db565b81815236602083850101111561157f575f5ffd5b816020840160208301375f60208383010152808752505050602084019350602081019050611530565b509095945050505050565b5f60a08284031280156115c4575f5ffd5b506115cd611461565b82356115d881611410565b815260208301356115e881611410565b6020820152604083013562ffffff81168114611602575f5ffd5b60408201526060830135600281900b811461161b575f5ffd5b606082015261162c60808401611427565b60808201529392505050565b634e487b7160e01b5f52601160045260245ffd5b5f600160ff1b820161166057611660611638565b505f0390565b5f60208284031215611676575f5ffd5b5051919050565b8181038181111561052757610527611638565b634e487b7160e01b5f52603260045260245ffd5b805161ffff811681146113cc575f5ffd5b5f5f5f5f5f60a086880312156116c9575f5ffd5b85516116d481611410565b60208701519095506116e581611410565b93506116f3604087016116a4565b9250611701606087016113bd565b60809690960151949793965091949392915050565b5f82601f830112611725575f5ffd5b815161173361150e826114db565b818152846020838601011115611747575f5ffd5b8160208501602083015e5f918101602001919091529392505050565b5f5f5f5f60808587031215611776575f5ffd5b845161178181611410565b602086015190945061179281611410565b92506117a0604086016116a4565b915060608501516001600160401b038111156117ba575f5ffd5b6117c687828801611716565b91505092959194509250565b5f82601f8301126117e1575f5ffd5b81516117ef61150e826114b9565b8082825260208201915060208360051b860101925085831115611810575f5ffd5b602085015b838110156118505780516001600160401b03811115611832575f5ffd5b611841886020838a0101611716565b84525060209283019201611815565b5095945050505050565b5f6020828403121561186a575f5ffd5b81516001600160401b0381111561187f575f5ffd5b61061f848285016117d2565b5f5f6040838503121561189c575f5ffd5b82516001600160401b038111156118b1575f5ffd5b8301601f810185136118c1575f5ffd5b80516118cf61150e826114b9565b8082825260208201915060208360051b8501019250878311156118f0575f5ffd5b6020840193505b8284101561191957611908846116a4565b8252602093840193909101906118f7565b8095505050505060208301516001600160401b03811115611938575f5ffd5b611944858286016117d2565b9150509250929050565b808202811582820484141761052757610527611638565b5f8261197f57634e487b7160e01b5f52601260045260245ffd5b500490565b84815283602082015260018060a01b0383166040820152608060608201525f6119b0608083018461137d565b9695505050505050565b5f5f604083850312156119cb575f5ffd5b505080516020909101519092909150565b5f602082840312156119ec575f5ffd5b81516001600160401b03811115611a01575f5ffd5b61061f8482850161171656fea2646970667358221220485fb7a20c130c0c540dff5b93e9429e6bcf178985b92b8ea7dedac45808c1ce64736f6c634300081e0033";

// This file is auto-generated. Do not edit.
export type ClientArgs = {
  publicClient: PublicClient;
  walletClient: WalletClient;
  chain: Chain;
  account?: Address;
};

export async function deployContract({
  chain,
  walletClient,
  publicClient,
  account,
}: ClientArgs): Promise<Address> {
  const hash = await walletClient.deployContract({
    abi: executorAbi,
    chain: chain,
    account: account || walletClient.account || null,
    bytecode,
  });

  const receipt = await publicClient.waitForTransactionReceipt({ hash });
  if (!receipt.contractAddress) {
    throw new Error("Contract deployment failed");
  }
  return receipt.contractAddress;
}
